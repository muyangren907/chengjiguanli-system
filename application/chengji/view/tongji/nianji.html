{extend name="common@list" /}
{block name="topnav"}
	<nav class="breadcrumb">
		<i class="Hui-iconfont">&#xe67f;</i> 首页
		<span class="c-gray en">&gt;</span> 成绩管理
		<span class="c-gray en">&gt;</span> 成绩列表
		<a class="btn btn-success radius r"
			style="line-height:1.6em;margin-top:3px"
			href="javascript:location.replace(location.href);"
			title="刷新" >
			<i class="Hui-iconfont">&#xe68f;</i>
	</a>
	</nav>
{/block}
{block name="bouttons"}
	<div class="panel panel-default mt-10 mb-10">
		<div class="panel-header" id="shaixuan">筛选</div>
		<div class="panel-body" style="min-height: 60px">
				<div>
					{php}
						$school = new app\system\model\School;
						$school = $school->searchMany('校级','校级');
					{/php}<label class="f-l">学校：</label>
					<dt>
						<dd class=" mt-10">
							{foreach $school as $key=>$vo } 
							<label class="ml-10">
								<input type="checkbox" value="{$vo.id}" name="school" onclick="dtreload()">
								{$vo.jiancheng}
							</label>
						{/foreach}
						</dd>
					</dt>
				</div>
				<div>
					{php}
						$njlist = nianjiList();
					{/php}
					<label class="f-l">年级：</label>
					{foreach $njlist as $key=>$vo } 
						<div class="radio-box">
							<input name="sex" type="radio" id="nj-{$key}" value="{$key}" name="nianji" onclick="dtreload()">
							<label for="nj-{$key}">{$vo}</label>
						</div>
					{/foreach}

				</div>
		</div>
	</div>

{/block}
{block name="tables"}
	<table id="table1" class="display" cellspacing="0" width="100%">
		<thead>
<!-- 			<tr>
				<th rowspan="2">序号</th>
				<th rowspan="2">班级</th>
				<th class="text-c" colspan="4" style="border: 0px;">语文</th>
				<th class="text-c" colspan="4" style="border: 0px;">数学</th>
				<th class="text-c" colspan="4" style="border: 0px;">英语</th>
			</tr> -->
			<tr>
				<th >序号</th>
				<th >班级</th>
				<th>人数</th>
				<th>平均分</th>
				<th>优秀率</th>
				<th>及格率</th>

				<th>人数</th>
				<th>平均分</th>
				<th>优秀率</th>
				<th>及格率</th>

				<th>人数</th>
				<th>平均分</th>
				<th>优秀率</th>
				<th>及格率</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	</table>


{/block}
{block name="myjs"}
<script type="text/javascript">

	// 定义DTajax参数
	var myajax = {
		url: "{:url('ajaxNianji')}",
		type: "post",
		data: {
			kaoshiid:"{$list.kaoshi}",
			school:function(){
				var chk = [];
				$('input[name="school"]:checked').each(function(){
					if(typeof($(this).val()) != "undefined")
					{
						chk.push($(this).val());
					}
				});
				return chk;
			},
			ruxuenian:function(){
				var a = $('input:radio:checked').val();
				if(typeof(a) == "undefined")
				{
					var date=new Date;
					a = date.getFullYear()-1; 
				}
				return a;
			},			
		},
	};

	// 定义列参数
	var mycolumns = [
        { "data": "id" },
        { "data": "title" },

        { "data": "data.yuwen.cnt" },
        { "data": "data.yuwen.avg" },
        { "data": "data.yuwen.youxiu" },
        { "data": "data.yuwen.jige" },

        { "data": "data.shuxue.cnt" },
        { "data": "data.shuxue.avg" },
        { "data": "data.shuxue.youxiu" },
        { "data": "data.shuxue.jige" },

        { "data": "data.waiyu.cnt" },
        { "data": "data.waiyu.avg" },
        { "data": "data.waiyu.youxiu" },
        { "data": "data.waiyu.jige" },
        
	];

		// 定义修改列参数
	var mycolumnDefs =[
		// 对象格式
        {
        	"orderable": false,
        	"targets": [0,-1]
        }, 
	];


	// 筛选成绩面板折叠
	$('#shaixuan').click(function(){
		$(this).next().toggle();
	});

	// 重载数据
	function dtreload()
	{
		mytable.ajax.reload();
	}

	
</script>
{/block}